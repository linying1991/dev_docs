<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <!-- classpage -- >
    <!-- RD version: 0.44.2  -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <meta name='description' content='  Class : WIN32OLE_EVENT  -   Ruby 2.5.2 ' />
  <!--  no EOL indicator  -->
  <meta content="2020-03-17 23:11:46 -0500" http-equiv="change-date" />
  <!-- rel_prefix  = ''  ENV['RDOC_FOR_WEBSITE']   = true-->
    
    
    
  <!-- rel_prefix = '.'   asset_rel_prefix = ''  --> 
  <title>Class: WIN32OLE_EVENT (Ruby 2.5.2) </title>
  <link rel="stylesheet" href="css/associated.css" type="text/css" >
  <!-- link rel="stylesheet" href=".css/obf.css"  -->
  <link rel="stylesheet" href="css/inuit.css" >
  <link rel="stylesheet" href="css/grid.inuit.css" >
  <link rel="stylesheet" href="css/2011.css" type="text/css" >
  <link rel="stylesheet" href="css/rdoc.css" type="text/css" >
    <link rel="stylesheet" href="css/carbon17.css" type="text/css" >


  <script src="/js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/rubydoc.js" type="text/javascript" charset="utf-8"></script> 


   
<script src="/js/highlight.min.js"></script>
<script> 
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script> 

  <style type='text/css'>

    #vulns-alert #vulns{
      background-color: #c33 ! important;
      width: 100%;
      text-align: center;
   }
   
   #vulns-alert #vulns a {
    color: #F99 ! important;
   }
 </style>

   <link rel="stylesheet" href="css/extra.css" type="text/css" >
  <script  src="/js/extra.js"  ></script>


</head>

<body id="top" class="class rdocstar">

<div id='actionbar' >
<div class='wrapper'>
  <ul class='grids g0'>
	<li class='grid-2' ><a href='/' target='_top' >Home</a></li>
	<li class='grid-2' ><a href='/core-2.5.2' target='_top' >Core 2.5.2</a></li>
	<li class='grid-2' ><a href='/stdlib-2.5.2' target='_top' >Std-lib 2.5.2</a></li>

   <li class='grid-2' ><a href='/downloads' target='_top' >Downloads</a></li>
	 <li class='grid-5 right' id='rd-action-search'><form id="searchbox_011815814100681837392:wnccv6st5qk" action="https://ruby-doc.com/search.html"><input type="hidden" name="cx" value="011815814100681837392:wnccv6st5qk" ><input  id='rd-search-input' name="q" type="text" size="20" >&#160;&#160;<input type="submit" name="sa" value="Search" ><input type="hidden" name="cof" value="FORID:9" ></form></li>
	</ul>
</div>
<span id='vulns-alert'></span>
<!-- VERSION HEADER for 2.5.2 NOT FOUND -->
</div> <!-- end action bar -->
 <div class='wrapper'>
  
   <!-- carbon17 added here 2017-09-09 -->
 
   <script src="//m.servedby-buysellads.com/monetization.js" type="text/javascript"></script>
<div class="bsa-cpc"></div>
<script>
  (function(){
    if(typeof _bsa !== 'undefined' && _bsa) {
    _bsa.init('default', 'CKYD627W', 'placement:rubydocorg', {
      target: '.bsa-cpc',
      align: 'horizontal',
      disable_css: 'true'
    });
      }
  })();
</script>

 

   <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
          
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul id='file-metadata'>

          
          
          
          <li class='in-file'>win32ole/win32ole_event.c</li>      
            
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-message_loop">::message_loop</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-handler">#handler</a></li>
          
          <li><a href="#method-i-handler-3D">#handler=</a></li>
          
          <li><a href="#method-i-off_event">#off_event</a></li>
          
          <li><a href="#method-i-on_event">#on_event</a></li>
          
          <li><a href="#method-i-on_event_with_outargs">#on_event_with_outargs</a></li>
          
          <li><a href="#method-i-unadvise">#unadvise</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
          
          
          
          <li><a href="./OLEProperty.html">OLEProperty</a></li>
        
          
          
          <li><a href="./WIN32OLE.html">WIN32OLE</a></li>
        
          
          
          <li><a href="./WIN32OLE/VARIANT.html">WIN32OLE::VARIANT</a></li>
        
          
          
          <li><a href="./WIN32OLEQueryInterfaceError.html">WIN32OLEQueryInterfaceError</a></li>
        
          
          
          <li><a href="./WIN32OLERuntimeError.html">WIN32OLERuntimeError</a></li>
        
          
          
          <li><a href="./WIN32OLE_EVENT.html">WIN32OLE_EVENT</a></li>
        
          
          
          <li><a href="./WIN32OLE_METHOD.html">WIN32OLE_METHOD</a></li>
        
          
          
          <li><a href="./WIN32OLE_PARAM.html">WIN32OLE_PARAM</a></li>
        
          
          
          <li><a href="./WIN32OLE_RECORD.html">WIN32OLE_RECORD</a></li>
        
          
          
          <li><a href="./WIN32OLE_TYPE.html">WIN32OLE_TYPE</a></li>
        
          
          
          <li><a href="./WIN32OLE_TYPELIB.html">WIN32OLE_TYPELIB</a></li>
        
          
          
          <li><a href="./WIN32OLE_VARIABLE.html">WIN32OLE_VARIABLE</a></li>
        
          
          
          <li><a href="./WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div> <!-- metadata -->
  <div class='adzbox'  id="azk83167">
    
   <div id="carbonads-container"><div class="carbonad">
<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CKYIKKQN&placement=rubydocorg" id="_carbonads_js"></script>
  </div></div>

   
  </div> 
  <div id="documentation">
    <h1 class="class">WIN32OLE_EVENT</h1>

    <div id="description" class="description">
      
<p><code>WIN32OLE_EVENT</code> objects controls OLE event.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="message_loop-method" class="method-detail ">
          <a name="method-c-message_loop"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">message_loop</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Translates and dispatches Windows message.</p>
            

            
            <div class="method-source-code" id="message_loop-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_s_msg_loop(VALUE klass)
{
    ole_msg_loop();
    return Qnil;
}
            </pre> 
            </div><!-- message_loop-source -->
            
          </div>

          

          
        </div><!-- message_loop-method -->
      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">new(ole, event) #=> WIN32OLE_EVENT object.</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns OLE event object. The first argument specifies <a
href="WIN32OLE.html">WIN32OLE</a> object. The second argument specifies OLE
event name.</p>

<pre class="ruby"><span class="ruby-identifier">ie</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'InternetExplorer.Application'</span>)
<span class="ruby-identifier">ev</span> = <span class="ruby-constant">WIN32OLE_EVENT</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ie</span>, <span class="ruby-string">'DWebBrowserEvents'</span>)
</pre>
            

            
            <div class="method-source-code" id="new-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_initialize(int argc, VALUE *argv, VALUE self)
{
    ev_advise(argc, argv, self);
    evs_push(self);
    rb_ivar_set(self, id_events, rb_ary_new());
    fev_set_handler(self, Qnil);
    return self;
}
            </pre> 
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->
      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="handler-method" class="method-detail ">
          <a name="method-i-handler"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_EVENT#handler</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>returns handler object.</p>
            

            
            <div class="method-source-code" id="handler-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_get_handler(VALUE self)
{
    return rb_ivar_get(self, rb_intern(&quot;handler&quot;));
}
            </pre> 
            </div><!-- handler-source -->
            
          </div>

          

          
        </div><!-- handler-method -->
      
        <div id="handler-3D-method" class="method-detail ">
          <a name="method-i-handler-3D"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_EVENT#handler=</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>sets event handler object. If handler object has onXXX method according to
XXX event, then onXXX method is called when XXX event occurs.</p>

<p>If handler object has method_missing and there is no method according to
the event, then method_missing called and 1-st argument is event name.</p>

<p>If handler object has onXXX method and there is block defined by <a
href="WIN32OLE_EVENT.html#method-i-on_event">#on_event</a>(‘XXX’){}, then
block is executed but handler object method is not called when XXX event
occurs.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Handler</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">onStatusTextChange</span>(<span class="ruby-identifier">text</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;StatusTextChanged&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">onPropertyChange</span>(<span class="ruby-identifier">prop</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;PropertyChanged&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">ev</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arg</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;other event #{ev}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">handler</span> = <span class="ruby-constant">Handler</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">ie</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'InternetExplorer.Application'</span>)
<span class="ruby-identifier">ev</span> = <span class="ruby-constant">WIN32OLE_EVENT</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ie</span>)
<span class="ruby-identifier">ev</span>.<span class="ruby-identifier">on_event</span>(<span class="ruby-string">&quot;StatusTextChange&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;this block executed.&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;handler.onStatusTextChange method is not called.&quot;</span>
}
<span class="ruby-identifier">ev</span>.<span class="ruby-identifier">handler</span> = <span class="ruby-identifier">handler</span>
</pre>
            

            
            <div class="method-source-code" id="handler-3D-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_set_handler(VALUE self, VALUE val)
{
    return rb_ivar_set(self, rb_intern(&quot;handler&quot;), val);
}
            </pre> 
            </div><!-- handler-3D-source -->
            
          </div>

          

          
        </div><!-- handler-3D-method -->
      
        <div id="off_event-method" class="method-detail ">
          <a name="method-i-off_event"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_EVENT#off_event([event])</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>removes the callback of event.</p>

<pre>ie = WIN32OLE.new('InternetExplorer.Application')
ev = WIN32OLE_EVENT.new(ie)
ev.on_event('BeforeNavigate2') {|*args|
  args.last[6] = true
}
  ...
ev.off_event('BeforeNavigate2')
  ...</pre>
            

            
            <div class="method-source-code" id="off_event-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_off_event(int argc, VALUE *argv, VALUE self)
{
    VALUE event = Qnil;
    VALUE events;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;event);
    if(!NIL_P(event)) {
        if(!RB_TYPE_P(event, T_STRING) &amp;&amp; !RB_TYPE_P(event, T_SYMBOL)) {
            rb_raise(rb_eTypeError, &quot;wrong argument type (expected String or Symbol)&quot;);
        }
        if (RB_TYPE_P(event, T_SYMBOL)) {
            event = rb_sym2str(event);
        }
    }
    events = rb_ivar_get(self, id_events);
    if (NIL_P(events)) {
        return Qnil;
    }
    ole_delete_event(events, event);
    return Qnil;
}
            </pre> 
            </div><!-- off_event-source -->
            
          </div>

          

          
        </div><!-- off_event-method -->
      
        <div id="on_event-method" class="method-detail ">
          <a name="method-i-on_event"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_EVENT#on_event([event]){...}</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Defines the callback event. If argument is omitted, this method defines the
callback of all events. If you want to modify reference argument in
callback, return hash in callback. If you want to return value to OLE
server as result of callback use `return’ or :return.</p>

<pre>ie = WIN32OLE.new('InternetExplorer.Application')
ev = WIN32OLE_EVENT.new(ie)
ev.on_event(&quot;NavigateComplete&quot;) {|url| puts url}
ev.on_event() {|ev, *args| puts &quot;#{ev} fired&quot;}

ev.on_event(&quot;BeforeNavigate2&quot;) {|*args|
  ...
  # set true to BeforeNavigate reference argument `Cancel'.
  # Cancel is 7-th argument of BeforeNavigate,
  # so you can use 6 as key of hash instead of 'Cancel'.
  # The argument is counted from 0.
  # The hash key of 0 means first argument.)
  {:Cancel =&gt; true}  # or {'Cancel' =&gt; true} or {6 =&gt; true}
}

ev.on_event(...) {|*args|
  {:return =&gt; 1, :xxx =&gt; yyy}
}</pre>
            

            
            <div class="method-source-code" id="on_event-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_on_event(int argc, VALUE *argv, VALUE self)
{
    return ev_on_event(argc, argv, self, Qfalse);
}
            </pre> 
            </div><!-- on_event-source -->
            
          </div>

          

          
        </div><!-- on_event-method -->
      
        <div id="on_event_with_outargs-method" class="method-detail ">
          <a name="method-i-on_event_with_outargs"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_EVENT#on_event_with_outargs([event]){...}</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Defines the callback of event. If you want modify argument in callback, you
could use this method instead of <a
href="WIN32OLE_EVENT.html#method-i-on_event">#on_event</a>.</p>

<pre class="ruby"><span class="ruby-identifier">ie</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'InternetExplorer.Application'</span>)
<span class="ruby-identifier">ev</span> = <span class="ruby-constant">WIN32OLE_EVENT</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ie</span>)
<span class="ruby-identifier">ev</span>.<span class="ruby-identifier">on_event_with_outargs</span>(<span class="ruby-string">'BeforeNavigate2'</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>[<span class="ruby-value">6</span>] = <span class="ruby-keyword">true</span>
}
</pre>
            

            
            <div class="method-source-code" id="on_event_with_outargs-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_on_event_with_outargs(int argc, VALUE *argv, VALUE self)
{
    return ev_on_event(argc, argv, self, Qtrue);
}
            </pre> 
            </div><!-- on_event_with_outargs-source -->
            
          </div>

          

          
        </div><!-- on_event_with_outargs-method -->
      
        <div id="unadvise-method" class="method-detail ">
          <a name="method-i-unadvise"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">WIN32OLE_EVENT#unadvise &rarr; nil</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>disconnects OLE server. If this method called, then the <a
href="WIN32OLE_EVENT.html">WIN32OLE_EVENT</a> object does not receive the
OLE server event any more. This method is trial implementation.</p>

<pre>ie = WIN32OLE.new('InternetExplorer.Application')
ev = WIN32OLE_EVENT.new(ie)
ev.on_event() {...}
   ...
ev.unadvise</pre>
            

            
            <div class="method-source-code" id="unadvise-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
fev_unadvise(VALUE self)
{
    struct oleeventdata *poleev;
    TypedData_Get_Struct(self, struct oleeventdata, &amp;oleevent_datatype, poleev);
    if (poleev-&gt;pConnectionPoint) {
        ole_msg_loop();
        evs_delete(poleev-&gt;event_id);
        poleev-&gt;pConnectionPoint-&gt;lpVtbl-&gt;Unadvise(poleev-&gt;pConnectionPoint, poleev-&gt;dwCookie);
        OLE_RELEASE(poleev-&gt;pConnectionPoint);
        poleev-&gt;pConnectionPoint = NULL;
    }
    OLE_FREE(poleev-&gt;pDispatch);
    return Qnil;
}
            </pre> 
            </div><!-- unadvise-source -->
            
          </div>

          

          
        </div><!-- unadvise-method -->
      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  
  <div id='tx_WIN32OLE_EVENT_versioned' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_WIN32OLE_EVENT_versioned").load("/associated/2.5.2/WIN32OLE_EVENT.ihtml");</script> <div id='tx_WIN32OLE_EVENT' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_WIN32OLE_EVENT").load("/associated/WIN32OLE_EVENT.ihtml");</script> 
      
  <!-- dsqus ? -->
     

  
  </div><!-- documentation -->
  <div id='dynamic'>
  </div>
      
          

      
<div class='grids wrapper' id="footer">
  <p><small>This page was generated for Ruby 2.5.2</small></p> 
  
   <p><a href="http://ruby-doc.org">Ruby-doc.org</a> is a service of <a href="http://jamesbritt.com">James Britt</a> and <a href="http://neurogami.com">Neurogami</a>, purveyors of fine dance noise.  <div class='oio-inline'><ins data-revive-zoneid="1" data-revive-id="58924a5717c091dfee6dda3f7d38c4d7"></ins><script async src="//ras.ruby-doc.org/vvv/delivery/thesinkjs.php"></script></div></p>
 
       <p><small>Generated with Ruby-doc Rdoc Generator 0.44.2</small>.</p>
  </div>
</div>
  
  

    
 <script type='text/javascript'>
$(document).ready(function() {
      $.ajaxSetup({ cache: false });
      $("#vulns-alert").load("/associated/vulns.ihtml");
    });

    </script>


 
		<script type='text/javascript'>

	function loadPlus(plusdocs){
			$(plusdocs).find("div[class='associated_wrapper']").each (function() {
					$("#" + this.id).append($(plusdocs).find("#" + this.id ));
					});
	} 

   //function loadInline(json){
   // for (var lookFor in json) {
    //  $(lookFor).after(json[lookFor]);
    // }
  // } // end loadInline


$(document).ready(function() {
		$.ajaxSetup({ cache: false });
			$.get('/associated/2.5.2/plus_WIN32OLE_EVENT.ihtml', 
			function(plusdocs) {
			setTimeout(function() {
				loadPlus(plusdocs);
				}, 2000);
			}
			);


//     $.ajax({
//     dataType: "json",
//      url: '/associated/2.5.2/inline_WIN32OLE_EVENT.js',
//      success: function(json) {
// 			setTimeout(function() {
// 				loadInline(json);
// 				}, 2000);
// 			}
//    });

		});
</script>
		
</body>
</html>


